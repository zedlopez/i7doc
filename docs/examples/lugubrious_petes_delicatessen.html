<!doctype html>
<html lang="en"><head><meta charset="utf-8">
<title>Ex. 435. Lugubrious Pete's Delicatessen</title>
<script src="../i7doc.js"></script>
<link rel="stylesheet" href="../i7doc.css">
</head>
<body><main>
<header class="example-header">
<nav><div class="nav-el"><a class="raw nav-el" href="../index.html">Contents</a></div><div class="nav-el"><a class="raw nav-el" href="../examples/index.html">Examples</a></div><div class="nav-el"><a class="raw nav-el" href="../general_index.html">Index</a></div><div class="nav-el"><a class="raw nav-el" href="../search.html">Search</a></div></nav>
<div class="superheading"><div class="heading"><h1>Lugubrious Pete's Delicatessen</h1><div class="subheading"><wbr><div class="ex-no">Example 435</div> ★</div></div>
<div class="doc-navbar example-linkback"><div class="doc-navbar-left"><a class="raw nav-el" href="../WI_21.html#section_11" title="Lists &gt; Variations: arrays, logs, queues, stacks, sets, sieves and rings"><div class="nav-arrow"><span class="sc">wi</span>&nbsp;21.11</div><div class="doc-navbar-text">Variations: arrays, logs, queues, stacks, sets, sieves and rings</div></a></div><div class="doc-navbar-right"><a class="raw nav-el" href="../RB_7.html#section_16" title="Other Characters &gt; Social Groups"><div class="doc-navbar-text">Social Groups</div><div class="nav-arrow"><span class="sc">rb</span>&nbsp;7.16</div></a></div></div>
</div>
<div class="example-meta-desc"><p>In this evocation of supermarket deli counter life, a list is used as a queue to keep track of who is waiting to be served.</p></div>
<div class="doc-navbar"><div class="doc-navbar-left"><a class="raw nav-el" href="i_didnt_come_all_the_way_from_great_portland_street.html" title="In this fiendishly difficult puzzle, which may perhaps owe some inspiration to a certain BBC Radio panel game (1967-), a list is used as a set of actions to help enforce the rule that the player must keep going for ten turns without hesitation, repetition, or deviating from the subject on the card."><div class="nav-arrow">⬅434. </div><div class="doc-navbar-text">I Didn't Come All The Way From Great Portland Street</div></a></div><div class="doc-navbar-right"><a class="raw nav-el" href="sieve_of_eratosthenes.html" title="The haughty Eratosthenes of Cyrene will nevertheless consent to sieve prime numbers on request."><div class="doc-navbar-text">Sieve of Eratosthenes</div><div class="nav-arrow">436.⮕</div></a></div></div>
</header>
<div class="example-body"><p>First, to set the scene:</p>
<div class="play-example borogove"><a class="raw" href="https://snippets.borogove.app/inform7/v10ex435">Play/modify in Borogove</a></div>
<div class="play-example quixe"><a class="raw" href="LugubriousPetes/index.html">Play in Quixe</a></div>
</p><div class="codeblock"><button class="copycode" title="Copy to clipboard" onclick="copyCode(`&quot;Lugubrious Pete&apos;s Delicatessen&quot;\n\nThe Supermarket is west of the Delicatessen Counter. Lugubrious Pete is in the Delicatessen. &quot;Lugubrious Pete, dolefully slicing meats and cheeses, serves at the counter.&quot; Alice, Beth, Gemma, Delia, and Eliza are women in the Supermarket.\n\nThe deli queue is a list of objects that varies.\n\n\nEvery turn when a woman is in the Supermarket and a random chance of 2 in 3 succeeds (this is the customer arriving rule):\n\tlet the customer be a random woman in the Supermarket;\n\tnow the customer is in the Delicatessen;\n\tif the player is in the Supermarket, say &quot;[The customer] walks into the Delicatessen.&quot;;\n\tif the player is in the Delicatessen, say &quot;[The customer] comes in from the Supermarket, and [if the number of entries in the deli queue is 0]can&apos;t believe her luck. The counter is free![otherwise]resignedly queues behind [the deli queue].&quot;;\n\tadd the customer to the deli queue.\n\n\nEvery turn when the number of entries in the deli queue is not 0 and a random chance of 1 in 3 succeeds (this is the customer being served rule):\n\tlet the customer be entry 1 of the deli queue;\n\tif the player is in the Delicatessen, say &quot;Pete gives a droopy expression as he serves [customer], who nevertheless brightens and leaves.&quot;;\n\tif the player is in the Supermarket, say &quot;[customer] emerges cheerfully from the Delicatessen Counter, and goes about her regular shopping.&quot;;\n\tnow the customer is in the Supermarket;\n\tremove entry 1 from the deli queue.\n\nInstead of waiting in the Delicatessen when the number of entries in the deli queue is not 0, say &quot;Time passes, for [deli queue] quite as much as for yourself.&quot;\n\nTest me with &quot;wait / wait / wait / east / wait / wait / wait / wait / wait&quot;.`)"><span class="sym">⧉</span></button><div class="codeline storytitle">&quot;Lugubrious Pete&#39;s Delicatessen&quot;</div>
<div class="codeline blankline">&thinsp;</div>
<div class="codeline">The Supermarket is west of the Delicatessen Counter. Lugubrious Pete is in the Delicatessen. &quot;Lugubrious Pete, dolefully slicing meats and cheeses, serves at the counter.&quot; Alice, Beth, Gemma, Delia, and Eliza are women in the Supermarket.</div>
<div class="codeline blankline">&thinsp;</div>
<div class="codeline">The deli queue is a list of objects that varies.</div>
</div><p>Two processes compete here: one that fills the queue, the other which will empty it. The first process is the one which brings shoppers in to the counter, joining the back of the queue, which is where &quot;add &hellip; to &hellip;&quot; puts new entries by default:</p>
<div class="codeblock"><div class="codeline">Every turn when a woman is in the Supermarket and a random chance of 2 in 3 succeeds (this is the customer arriving rule):</div>
<div class="codeline">&ensp;&ensp;&ensp;let the customer be a random woman in the Supermarket;</div>
<div class="codeline">&ensp;&ensp;&ensp;now the customer is in the Delicatessen;</div>
<div class="codeline">&ensp;&ensp;&ensp;if the player is in the Supermarket, say &quot;[The customer] walks into the Delicatessen.&quot;;</div>
<div class="codeline">&ensp;&ensp;&ensp;if the player is in the Delicatessen, say &quot;[The customer] comes in from the Supermarket, and [if the number of entries in the deli queue is 0]can&#39;t believe her luck. The counter is free![otherwise]resignedly queues behind [the deli queue].&quot;;</div>
<div class="codeline">&ensp;&ensp;&ensp;add the customer to the deli queue.</div>
</div><p>The competing process is the one which serves shoppers and thus gets rid of them again: unfortunately, it is slower. But Pete is fair if inefficient, and serves the customers in strict order of arrival. Each served customer is removed from the front of the list, and the others therefore all move up a place.</p>
<div class="codeblock"><div class="codeline">Every turn when the number of entries in the deli queue is not 0 and a random chance of 1 in 3 succeeds (this is the customer being served rule):</div>
<div class="codeline">&ensp;&ensp;&ensp;let the customer be entry 1 of the deli queue;</div>
<div class="codeline">&ensp;&ensp;&ensp;if the player is in the Delicatessen, say &quot;Pete gives a droopy expression as he serves [customer], who nevertheless brightens and leaves.&quot;;</div>
<div class="codeline">&ensp;&ensp;&ensp;if the player is in the Supermarket, say &quot;[customer] emerges cheerfully from the Delicatessen Counter, and goes about her regular shopping.&quot;;</div>
<div class="codeline">&ensp;&ensp;&ensp;now the customer is in the Supermarket;</div>
<div class="codeline">&ensp;&ensp;&ensp;remove entry 1 from the deli queue.</div>
<div class="codeline blankline">&thinsp;</div>
<div class="codeline">Instead of waiting in the Delicatessen when the number of entries in the deli queue is not 0, say &quot;Time passes, for [deli queue] quite as much as for yourself.&quot;</div>
<div class="codeline blankline">&thinsp;</div>
<div class="codeline">Test me with &quot;wait / wait / wait / east / wait / wait / wait / wait / wait&quot;.</div>
</div><details class="testme-output"><summary><div class="summation">Test me with "wait / wait / wait / east / wait / wait / wait / wait / wait".</div></summary><div class="testme-output">Supermarket<br>You can see Alice, Beth, Gemma, Delia and Eliza here.<br><br><span class="mono">&gt;(Testing.)</span><br><br><span class="mono">&gt;[1] wait</span><br>Time passes.<br><br>Alice walks into the Delicatessen.<br><br><span class="mono">&gt;[2] wait</span><br>Time passes.<br><br>Beth walks into the Delicatessen.<br><br>Alice emerges cheerfully from the Delicatessen Counter, and goes about her regular shopping.<br><br><span class="mono">&gt;[3] wait</span><br>Time passes.<br><br>Delia walks into the Delicatessen.<br><br>Beth emerges cheerfully from the Delicatessen Counter, and goes about her regular shopping.<br><br><span class="mono">&gt;[4] east</span><br><br>Delicatessen Counter<br>Lugubrious Pete, dolefully slicing meats and cheeses, serves at the counter.<br><br>You can also see Delia here.<br><br><span class="mono">&gt;[5] wait</span><br>Time passes, for Delia quite as much as for yourself.<br><br><span class="mono">&gt;[6] wait</span><br>Time passes, for Delia quite as much as for yourself.<br><br>Alice comes in from the Supermarket, and resignedly queues behind Delia.<br><br><span class="mono">&gt;[7] wait</span><br>Time passes, for Delia and Alice quite as much as for yourself.<br><br>Eliza comes in from the Supermarket, and resignedly queues behind Delia and Alice.<br><br>Pete gives a droopy expression as he serves Delia, who nevertheless brightens and leaves.<br><br><span class="mono">&gt;[8] wait</span><br>Time passes, for Alice and Eliza quite as much as for yourself.<br><br>Gemma comes in from the Supermarket, and resignedly queues behind Alice and Eliza.<br><br><span class="mono">&gt;[9] wait</span><br>Time passes, for Alice, Eliza and Gemma quite as much as for yourself.<br><br>Beth comes in from the Supermarket, and resignedly queues behind Alice, Eliza and Gemma.
</div></details><p>That completes the example, but here is a variation to show that queues need not empty from the front. The Deli already looks a pretty sexist establishment, with the customers all being women, but it is about to get a whole lot worse:</p>
<div class="codeblock"><div class="codeline">Modesty is a kind of value. The modesties are positively prim, buttoned up, modest, flirty, revealing and downright immodest. Every woman has a modesty. Alice is positively prim. Beth is downright immodest. Gemma is modest. Delia is flirty. Eliza is revealing.</div>
</div><p>We could then rewrite the service rule like so:</p>
<div class="codeblock"><div class="codeline">Every turn when the number of entries in the deli queue is not 0 and a random chance of 1 in 3 succeeds (this is the customer being served rule):</div>
<div class="codeline">&ensp;&ensp;&ensp;let Pete&#39;s preference be the deli queue;</div>
<div class="codeline">&ensp;&ensp;&ensp;sort Pete&#39;s preference in reverse modesty order;</div>
<div class="codeline">&ensp;&ensp;&ensp;let the customer be entry 1 of Pete&#39;s preference;</div>
<div class="codeline">&ensp;&ensp;&ensp;let the first in line be entry 1 of the deli queue;</div>
<div class="codeline">&ensp;&ensp;&ensp;if the player is in the Delicatessen, say &quot;[if the customer is the first in line]Pete gives a droopy expression as he serves [the customer], who nevertheless brightens and leaves.[otherwise]Outrageously, Pete scans the queue, notices [the customer] in her [modesty of the customer] clothes, and serves her next, while [the first in line] glares at him.&quot;;</div>
<div class="codeline">&ensp;&ensp;&ensp;if the player is in the Supermarket, say &quot;[The customer] emerges cheerfully from the Delicatessen Counter, and goes about her regular shopping.&quot;;</div>
<div class="codeline">&ensp;&ensp;&ensp;now the customer is in the Supermarket;</div>
<div class="codeline">&ensp;&ensp;&ensp;remove the customer from the deli queue.</div>
</div><p>It is now heartbreakingly difficult for Alice to obtain her sliced chorizo sausage.</p>
</div><div class="doc-navbar"><div class="doc-navbar-left"><a class="raw nav-el" href="i_didnt_come_all_the_way_from_great_portland_street.html" title="In this fiendishly difficult puzzle, which may perhaps owe some inspiration to a certain BBC Radio panel game (1967-), a list is used as a set of actions to help enforce the rule that the player must keep going for ten turns without hesitation, repetition, or deviating from the subject on the card."><div class="nav-arrow">⬅434. </div><div class="doc-navbar-text">I Didn't Come All The Way From Great Portland Street</div></a></div><div class="doc-navbar-right"><a class="raw nav-el" href="sieve_of_eratosthenes.html" title="The haughty Eratosthenes of Cyrene will nevertheless consent to sieve prime numbers on request."><div class="doc-navbar-text">Sieve of Eratosthenes</div><div class="nav-arrow">436.⮕</div></a></div></div>
</main><footer id="credits-footer"><nav><div class="nav-el"><a class="raw nav-el" href="../index.html">Contents</a></div><div class="nav-el"><a class="raw nav-el" href="../examples/index.html">Examples</a></div><div class="nav-el"><a class="raw nav-el" href="../general_index.html">Index</a></div><div class="nav-el"><a class="raw nav-el" href="../search.html">Search</a></div></nav>
<div class="footing"><p id="i7credit"><a href="http://inform7.com">Inform 7</a> and its documentation are &copy; 2006-<span id="current_year">2022</span> by Graham Nelson and published under the <a href="../license.html">Artistic License 2.0</a>.</p><p class="about"><a class="raw" href="../about.html">About this edition</a>&ensp;&bull;&ensp;<a class="raw" href="https://mastodon.gamedev.place/web/@inform7tips">@inform7tips@mastodon.gamedev.place</a></p></div></footer>
</body></html>
