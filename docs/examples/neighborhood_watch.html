<!doctype html>
<html lang="en"><head><meta charset="utf-8">
<title>Ex. 24. Neighborhood Watch</title>
<script src="../i7doc.js"></script>
<link rel="stylesheet" href="../i7doc.css">
</head>
<body>
<header class="example-header">
<nav><div class="nav-el"><a class="nav-el" href="../index.html">Contents</a></div><div class="nav-el"><a class="nav-el" href="../examples/index.html">Examples</a></div><div class="nav-el"><a class="nav-el" href="../general_index.html">Index</a></div><div class="nav-el"><a class="nav-el" href="../search.html">Search</a></div></nav>
<div class="superheading"><div class="heading"><h1>Neighborhood Watch</h1><div class="subheading">Example 24 ★★</div></div></div>
<div class="linkback">
<a href="../WI_3.html#section_13" title="Things &gt; Locks and keys">WI §3.13 Locks and keys</a><br><a href="../RB_3.html#section_5" title="Place &gt; Doors, Staircases, and Bridges">RB §3.5 Doors, Staircases, and Bridges</a>
</div>
<p class="example-desc">A locked door that can be locked or unlocked without a key from one side, but not from the other.</p>
<div class="doc-navbar"><div class="doc-navbar-left"><a class="nav-el" href="disenchantment_bay6.html" title="Disenchantment Bay: locking up the charter boat&#39;s fishing rods."><div class="nav-arrow">←23. </div><div class="doc-navbar-text">Disenchantment Bay 6</div></a></div><div class="doc-navbar-right"><a class="nav-el" href="disenchantment_bay7.html" title="Disenchantment Bay: making the radar and instruments switch on and off."><div class="doc-navbar-text">Disenchantment Bay 7</div><div class="nav-arrow">25.→</div></a></div></div>
</header>
<p>Suppose we want a locked door that can be opened with a key, but is also openable by hand without a key from one side only. We start by defining an ordinary lockable door and the key that controls it:</p>
<p><span class="borogove-link"><a href="https://snippets.borogove.app/inform7/v10ex24">Play/modify Neighborhood Watch in Borogove</a></span>
 &bull; <span class="quixe-link"><a href="Deadbolt/index.html">Play Neighborhood Watch in Quixe</a></span>
</p><div class="codeblock"><button class="copycode" title="Copy to clipboard" onclick="copyCode(`&quot;Neighborhood Watch&quot;\n\nThe shabby door is a door. It is outside from the Studio Apartment and inside from the Rickety Stairwell. The shabby door is locked.\n\nThe brass key is carried by the player. It unlocks the shabby door.\n\n\nUnderstand &quot;lock [something]&quot; as locking keylessly. Locking keylessly is an action applying to one thing.\n\n\nCheck locking keylessly:\n\tif the noun is not a door, say &quot;[The noun] is not something you can lock.&quot; instead;\n\tif the noun is locked, say &quot;[The noun] is already locked.&quot; instead;\n\tif the player carries the brass key and the player is in the Stairwell, try locking the noun with the brass key instead;\n\tif the player is in the Stairwell, say &quot;You can&apos;t lock the door from this side without the key.&quot; instead.\n\n\nCarry out locking keylessly:\n\tnow the noun is locked.\n\n\nReport locking keylessly:\n\tsay &quot;You flip over the deadbolt to lock [the noun].&quot;\n\n\nUnderstand &quot;unlock [something]&quot; as unlocking keylessly. Unlocking keylessly is an action applying to one thing.\n\nCheck unlocking keylessly:\n\tif the noun is not a door, say &quot;[The noun] is not something you can lock.&quot; instead;\n\tif the noun is unlocked, say &quot;[The noun] is already unlocked.&quot; instead;\n\tif the player carries the brass key and the player is in the Stairwell, try unlocking the noun with the brass key instead;\n\tif the player is in the Stairwell, say &quot;You can&apos;t unlock the door from this side without the key.&quot; instead.\n\nCarry out unlocking keylessly:\n\tnow the noun is unlocked.\n\nReport unlocking keylessly:\n\tsay &quot;You flip over the deadbolt to unlock [the noun].&quot;\n\nTest me with &quot;unlock door / drop key / open door / out / close door / lock door / open door / in / get key / out / close door / lock door / unlock door&quot;.`)">⧉</button><div class="codeline storytitle">&quot;Neighborhood Watch&quot;</div>
<div class="codeline">&ensp;&ensp;&ensp;</div>
<div class="codeline">The shabby door is a door. It is outside from the Studio Apartment and inside from the Rickety Stairwell. The shabby door is locked.</div>
<div class="codeline">&ensp;&ensp;&ensp;</div>
<div class="codeline">The brass key is carried by the player. It unlocks the shabby door.</div>
</div><p>The next part is going to require that we modify the normal operation of the &quot;lock&quot; command. &quot;Lock&quot; ordinarily requires that the player supply two objects: a thing he wants to unlock, and the key he wants to use on it. The full command is LOCK DOOR WITH THE KEY, and Inform will not accept simply LOCK DOOR as locking.</p>
<p>Therefore, we&#39;re going to need to create our own new variant on the lock verb (and the unlock verb, while we&#39;re at it). The full procedure for this is laid out in the chapters on Action and Understanding, but here is an example:</p>
<div class="codeblock"><div class="codeline">Understand &quot;lock [something]&quot; as locking keylessly. Locking keylessly is an action applying to one thing.</div>
</div><p>Here we&#39;ve created a new action &ndash; locking something without a key &ndash; and we&#39;ve told Inform to understand LOCK DOOR as this action, rather than an incomplete command to LOCK DOOR WITH SOMETHING.</p>
<p>Now we add some instructions so that the game will not let us use this keyless unlocking command unless we&#39;re in the right place or are properly equipped:</p>
<div class="codeblock"><div class="codeline">Check locking keylessly:</div>
<div class="codeline">&ensp;&ensp;&ensp;if the noun is not a door, say &quot;[The noun] is not something you can lock.&quot; instead;</div>
<div class="codeline">&ensp;&ensp;&ensp;if the noun is locked, say &quot;[The noun] is already locked.&quot; instead;</div>
<div class="codeline">&ensp;&ensp;&ensp;if the player carries the brass key and the player is in the Stairwell, try locking the noun with the brass key instead;</div>
<div class="codeline">&ensp;&ensp;&ensp;if the player is in the Stairwell, say &quot;You can&#39;t lock the door from this side without the key.&quot; instead.</div>
</div><p>This check rule is performed before the keyless locking action succeeds. The first thing we do is try to use the key if the player is outside and has the key: this way, LOCK DOOR will turn automatically into LOCK DOOR WITH THE KEY, under circumstances where that is both possible and necessary.</p>
<p>The second thing is to check whether the player is outside but keyless, and, if so stop the action from being performed successfully. Here we print a failure message followed by the word &quot;instead&quot;, which tells Inform that we&#39;ve substituted some other outcome for the usual performance of the action.</p>
<p>Now we&#39;re reasonably sure that the player is only locking keylessly in the case that he is inside the Studio. (We might have to do a more thorough check for this if there were more than two rooms, but as it is, the player can only be in the Stairwell or in the Studio, so if we have ruled out the Stairwell, we are safe.) So now we want to add what happens when locking-without-a-key command succeeds:</p>
<div class="codeblock"><div class="codeline">Carry out locking keylessly:</div>
<div class="codeline">&ensp;&ensp;&ensp;now the noun is locked.</div>
</div><p>That&#39;s it. We&#39;ve just told Inform to make the door be locked. &quot;Now&hellip;&quot; syntax will be explained more thoroughly in the <a href="WI_8.html">chapter on change</a>. But we still haven&#39;t described to the player what just happened, so let&#39;s provide a description of that, too:</p>
<div class="codeblock"><div class="codeline">Report locking keylessly:</div>
<div class="codeline">&ensp;&ensp;&ensp;say &quot;You flip over the deadbolt to lock [the noun].&quot;</div>
</div><p>And now we have to do a similar set of things for unlocking:</p>
<div class="codeblock"><div class="codeline">Understand &quot;unlock [something]&quot; as unlocking keylessly. Unlocking keylessly is an action applying to one thing.</div>
<div class="codeline">&ensp;&ensp;&ensp;</div>
<div class="codeline">Check unlocking keylessly:</div>
<div class="codeline">&ensp;&ensp;&ensp;if the noun is not a door, say &quot;[The noun] is not something you can lock.&quot; instead;</div>
<div class="codeline">&ensp;&ensp;&ensp;if the noun is unlocked, say &quot;[The noun] is already unlocked.&quot; instead;</div>
<div class="codeline">&ensp;&ensp;&ensp;if the player carries the brass key and the player is in the Stairwell, try unlocking the noun with the brass key instead;</div>
<div class="codeline">&ensp;&ensp;&ensp;if the player is in the Stairwell, say &quot;You can&#39;t unlock the door from this side without the key.&quot; instead.</div>
<div class="codeline">&ensp;&ensp;&ensp;</div>
<div class="codeline">Carry out unlocking keylessly:</div>
<div class="codeline">&ensp;&ensp;&ensp;now the noun is unlocked.</div>
<div class="codeline">&ensp;&ensp;&ensp;</div>
<div class="codeline">Report unlocking keylessly:</div>
<div class="codeline">&ensp;&ensp;&ensp;say &quot;You flip over the deadbolt to unlock [the noun].&quot;</div>
<div class="codeline">&ensp;&ensp;&ensp;</div>
<div class="codeline">Test me with &quot;unlock door / drop key / open door / out / close door / lock door / open door / in / get key / out / close door / lock door / unlock door&quot;.</div>
</div><details class="testme-output"><summary><div class="summation"><div class="consummation">Test me with "unlock door / drop key / open door / out / close door / lock door / open door / in / get key / out / close door / lock door / unlock door".</div></div></summary><div class="testme-output">Studio Apartment<br>You can see a shabby door here.<br><br><span class="mono">&gt;(Testing.)</span><br><br><span class="mono">&gt;[1] unlock door</span><br>You flip over the deadbolt to unlock the shabby door.<br><br><span class="mono">&gt;[2] drop key</span><br>Dropped.<br><br><span class="mono">&gt;[3] open door</span><br>You open the shabby door.<br><br><span class="mono">&gt;[4] out</span><br><br>Rickety Stairwell<br>You can see a shabby door here.<br><br><span class="mono">&gt;[5] close door</span><br>You close the shabby door.<br><br><span class="mono">&gt;[6] lock door</span><br>You can&#39;t lock the door from this side without the key.<br><br><span class="mono">&gt;[7] open door</span><br>You open the shabby door.<br><br><span class="mono">&gt;[8] in</span><br><br>Studio Apartment<br>You can see a shabby door and a brass key here.<br><br><span class="mono">&gt;[9] get key</span><br>Taken.<br><br><span class="mono">&gt;[10] out</span><br><br>Rickety Stairwell<br>You can see a shabby door here.<br><br><span class="mono">&gt;[11] close door</span><br>You close the shabby door.<br><br><span class="mono">&gt;[12] lock door</span><br>You lock the shabby door.<br><br><span class="mono">&gt;[13] unlock door</span><br>You unlock the shabby door.
</div></details><p>Some (but not all) of this work is done for you if you like by the Locksmith extension. If you prefer, you can include that extension, then follow the documentation in order to implement the remainder of the scenario. Locksmith takes care of implementing the additional locking and unlocking actions, and provides some other conveniences.</p>
<div class="doc-navbar"><div class="doc-navbar-left"><a class="nav-el" href="disenchantment_bay6.html" title="Disenchantment Bay: locking up the charter boat&#39;s fishing rods."><div class="nav-arrow">←23. </div><div class="doc-navbar-text">Disenchantment Bay 6</div></a></div><div class="doc-navbar-right"><a class="nav-el" href="disenchantment_bay7.html" title="Disenchantment Bay: making the radar and instruments switch on and off."><div class="doc-navbar-text">Disenchantment Bay 7</div><div class="nav-arrow">25.→</div></a></div></div>
<footer id="credits-footer"><nav><div class="nav-el"><a class="nav-el" href="../index.html">Contents</a></div><div class="nav-el"><a class="nav-el" href="../examples/index.html">Examples</a></div><div class="nav-el"><a class="nav-el" href="../general_index.html">Index</a></div><div class="nav-el"><a class="nav-el" href="../search.html">Search</a></div></nav>
<div class="footing"><p id="i7credit"><a href="http://inform7.com">Inform 7</a> and its documentation are &copy; 2006-<span id="current_year">2022</span> by Graham Nelson and published under the <a href="../license.html">Artistic License 2.0</a>.</p><p class="about"><a class="nav-about" href="../about.html">About this edition</a> &bull; <a class="nav-about" href="https://twitter.com/inform7tips">@inform7tips</a></p></div></footer>
</body></html>
