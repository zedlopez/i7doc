<!doctype html>
<html lang="en"><head><meta charset="utf-8">
<title>Ex. 358. Priority Lab</title>
<script src="../i7doc.js"></script>
<link rel="stylesheet" href="../i7doc.css">
</head>
<body>
<header class="example-header">
<nav><div class="nav-el"><a href="../index.html">Contents</a></div> <div class="nav-el"><a href="../examples/index.html">Examples</a></div> <div class="nav-el"><a href="../general_index.html">Index</a></div> <div class="nav-el"><a href="../search.html">Search</a></div></nav>
<h1>Priority Lab</h1><div class="subheading">Example 358 ★</div>
<div class="linkback">
<a href="../WI_18.html#section_26" title="Activities &gt; Printing the locale description of something">WI §18.26 Printing the locale description of something</a><br><a href="../RB_3.html#section_1" title="Place &gt; Room Descriptions">RB §3.1 Room Descriptions</a>
</div>
<p class="example-desc">A debugging rule useful for checking the priorities of objects about to be listed.</p>
<div class="doc-navbar"><div class="doc-navbar-left"><a href="eye_of_the_idol.html" title="A systematic way to allow objects in certain places to be described in the room description body text rather than in paragraphs following the room description, and to control whether supporters list their contents or not.">357. The Eye of the Idol</a></div><div class="doc-navbar-right"><a href="low_light.html" title="An object that is only visible and manipulable when a bright light fixture is on.">359. Low Light</a></div></div>
</header>
<p>When it comes time to start manipulating the priorities of items, it is useful to be able to check the table for debugging purposes; the problem is that printing the names of the objects can itself affect the way the room description is generated, foiling our debugging efforts.</p>
<p>What follows is a rule to help with debugging safely, and a sample of how priorities work:</p>
<p><span class="borogove-link"><a href="https://snippets.borogove.app/inform7/v10ex358">Play/modify Priority Lab in Borogove</a></span>
 &bull; <span class="quixe-link"><a href="PriorityLab/index.html">Play Priority Lab in Quixe</a></span>
</p><div class="codeblock"><button class="copycode" title="Copy to clipboard" onclick="copyCode(`&quot;Priority Lab&quot;\n\nSection 1 - Procedure\n\nBefore printing the locale description (this is the dump locale table rule):\n\tsay &quot;Locale Priority list:&quot;;\n\trepeat through Table of Locale Priorities:\n\t\tlet the flag be whether or not the notable-object entry is mentioned;\n\t\tsay &quot;[line break]  [notable-object entry]: [locale description priority entry]&quot;;\n\t\tif the flag is false, now the notable-object entry is not mentioned;\n\tsay line break.\n\n\nA thing can be early-described, late-described, latest-described, never-described, sightline-described, or ordinarily-described. A thing is usually ordinarily-described.\n\nAfter choosing notable locale objects (this is the apply early and late description rule):\n\trepeat with item running through early-described things:\n\t\tif there is a notable-object of item in the Table of Locale Priorities:\n\t\t\tset the locale priority of the item to 1; [list before everything else -- this would work with any number lower than 5 and higher than 0]\n\trepeat with item running through late-described things:\n\t\tif there is a notable-object of item in the Table of Locale Priorities:\n\t\t\tset the locale priority of the item to 10; [list after everything else -- this would work with any number larger than 5]\n\trepeat with item running through never-described things:\n\t\tset the locale priority of the item to 0; [don&apos;t list at all]\n\tcontinue the activity.\n\n\nAfter choosing notable locale objects (this is the sightline-described things are visible from supporters rule):\n\tif the player is not on a supporter:\n\t\trepeat with item running through sightline-described things:\n\t\t\tif there is a notable-object of item in the Table of Locale Priorities:\n\t\t\t\tset the locale priority of the item to 0; [remove objects that can only be seen from higher objects.]\n\tcontinue the activity.\n\n\n\nA thing can be tasteful or icky. A thing is usually tasteful.\n\nAfter choosing notable locale objects (this is the icky things next to players rule):\n\tif the player is on the parameter-object:\n\t\trepeat with item running through icky things :\n\t\t\tif there is a notable-object of item in the Table of Locale Priorities:\n\t\t\t\tset the locale priority of the item to 10; [remove objects that can only be seen from higher objects.]\n\tcontinue the activity.\n\n\nAfter choosing notable locale objects (this is the latest-described items priority rule):\n\trepeat with item running through latest-described things:\n\t\tif the item is a notable-object listed in the Table of Locale Priorities:\n\t\t\tnow the item is mentioned;\n\t\t\tnow the item is marked for late listing.\n\nThe late listing rule is listed after the you-can-also-see rule in the for printing the locale description rules.\n\nA thing can be marked for late listing. A thing is usually not marked for late listing.\n\nThis is the late listing rule:\n\tif something is marked for late listing:\n\t\tsay &quot;Oh! And also [a list of things which are marked for late listing].&quot;;\n\t\tnow everything is not marked for late listing;\n\tcontinue the activity.\n\nSection 2 - Scenario\n\nThe Priority Lab is a room. The early bird, the worm, the leaf, the unseen object, the pebble, the twig, and the late edition are things in the Priority Lab.\n\nThe early bird is early-described. The late edition is late-described. The unseen object is never-described.\n\nThe worm is icky.\n\nThe high window is in Priority Lab. It is sightline-described and fixed in place. The initial appearance of the high window is &quot;There&apos;s a tiny high window up near the ceiling that you can&apos;t see unless you&apos;re on top of something.&quot;\n\n\nThe initial appearance of the worm is &quot;A worm inches along the ground.&quot;\nThe initial appearance of the late edition is &quot;Finally, the late edition lies at your feet.&quot;\n\nRule for writing a paragraph about the early bird when the early bird is in a room: say &quot;The early bird always appears first, and here it is.&quot;\nRule for writing a paragraph about the leaf: say &quot;Look, there&apos;s [a leaf][unless the leaf is in the location] on [the holder of the leaf][end if]!&quot;\nRule for writing a paragraph about an icky thing (called icky item) which is on something which supports the player: say &quot;Ew, [an icky item] is right next to you.&quot;\n\n\nThe afterthought is a thing in the Priority Lab. It is latest-described.\n\nThe bar stool is an enterable supporter in Priority Lab.\n\nTest me with &quot;get leaf / drop leaf / look / x unseen object / get pebble / look / get twig / look / get afterthought / look / drop twig / look / get late edition / look / drop late edition / sit on bar stool / look / get all / put all on stool / look&quot;.`)">⧉</button><div class="codeline storytitle">&quot;Priority Lab&quot;</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline i7header">Section 1 - Procedure</div><div class="codeline">Before printing the locale description (this is the dump locale table rule):</div>
<div class="codeline">&ensp;&ensp;say &quot;Locale Priority list:&quot;;</div>
<div class="codeline">&ensp;&ensp;repeat through Table of Locale Priorities:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;let the flag be whether or not the notable-object entry is mentioned;</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;say &quot;[line break]  [notable-object entry]: [locale description priority entry]&quot;;</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;if the flag is false, now the notable-object entry is not mentioned;</div>
<div class="codeline">&ensp;&ensp;say line break.</div>
</div><p>Now, let&#39;s look at some items put in a specific order. Things with low priority numbers list towards the beginning; things with high priority numbers list towards the end. (It helps to think of it as though we were making a numbered list of the paragraphs to appear in the description.) Anything numbered 0 doesn&#39;t appear at all, and the default priority of an object is 1.</p>
<div class="codeblock"><div class="codeline">A thing can be early-described, late-described, latest-described, never-described, sightline-described, or ordinarily-described. A thing is usually ordinarily-described.</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline">After choosing notable locale objects (this is the apply early and late description rule):</div>
<div class="codeline">&ensp;&ensp;repeat with item running through early-described things:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;if there is a notable-object of item in the Table of Locale Priorities:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;set the locale priority of the item to 1; [list before everything else -- this would work with any number lower than 5 and higher than 0]</div>
<div class="codeline">&ensp;&ensp;repeat with item running through late-described things:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;if there is a notable-object of item in the Table of Locale Priorities:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;set the locale priority of the item to 10; [list after everything else -- this would work with any number larger than 5]</div>
<div class="codeline">&ensp;&ensp;repeat with item running through never-described things:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;set the locale priority of the item to 0; [don&#39;t list at all]</div>
<div class="codeline">&ensp;&ensp;continue the activity.</div>
</div><p>An important cautionary note: priorities are only honored if the objects are going to get their own paragraphs (with &quot;writing a paragraph about&hellip;&quot; or because they have initial appearances). Priorities do not affect the order in which items appear in the final &quot;You can see&hellip;&quot; list, except that items with priority 0 or lower are omitted. (If we want to order the items in that list, we may want to resort to the Complex Listing extension by Emily Short.)</p>
<p>There are further refinements available to us: for instance, we could make some things that are only visible if the player is raised above ground level.</p>
<div class="codeblock"><div class="codeline">After choosing notable locale objects (this is the sightline-described things are visible from supporters rule):</div>
<div class="codeline">&ensp;&ensp;if the player is not on a supporter:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;repeat with item running through sightline-described things:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;if there is a notable-object of item in the Table of Locale Priorities:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;set the locale priority of the item to 0; [remove objects that can only be seen from higher objects.]</div>
<div class="codeline">&ensp;&ensp;continue the activity.</div>
</div><p>It may also be useful to know about the &quot;parameter-object&quot;, which refers to the thing whose contents we are currently describing: the standard rules consider how to describe the contents of the location and then also check the contents of any supporter or container the player may be inside, so in the first case &quot;parameter-object&quot; would be the location, and then in the second the supporter in question.</p>
<p>In practice this is rarely useful, but should we need to change priorities in the case of both player and object being inside a particular container, we might make use of it, for instance:</p>
<div class="codeblock"><div class="codeline">A thing can be tasteful or icky. A thing is usually tasteful.</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline">After choosing notable locale objects (this is the icky things next to players rule):</div>
<div class="codeline">&ensp;&ensp;if the player is on the parameter-object:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;repeat with item running through icky things :</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;if there is a notable-object of item in the Table of Locale Priorities:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;set the locale priority of the item to 10; [remove objects that can only be seen from higher objects.]</div>
<div class="codeline">&ensp;&ensp;continue the activity.</div>
</div><p>The other thing to note is that by default that final collection of generic objects (&quot;You can also see&hellip;&quot;) appears at the end, regardless of the priority of everything else. If we really wanted to, though, we could force something to appear even after that paragraph, by adding a new listing rule to the locale description rules:</p>
<div class="codeblock"><div class="codeline">After choosing notable locale objects (this is the latest-described items priority rule):</div>
<div class="codeline">&ensp;&ensp;repeat with item running through latest-described things:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;if the item is a notable-object listed in the Table of Locale Priorities:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;now the item is mentioned;</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;now the item is marked for late listing.</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline">The late listing rule is listed after the you-can-also-see rule in the for printing the locale description rules.</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline">A thing can be marked for late listing. A thing is usually not marked for late listing.</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline">This is the late listing rule:</div>
<div class="codeline">&ensp;&ensp;if something is marked for late listing:</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;say &quot;Oh! And also [a list of things which are marked for late listing].&quot;;</div>
<div class="codeline">&ensp;&ensp;&ensp;&ensp;now everything is not marked for late listing;</div>
<div class="codeline">&ensp;&ensp;continue the activity.</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline i7header">Section 2 - Scenario</div><div class="codeline">The Priority Lab is a room. The early bird, the worm, the leaf, the unseen object, the pebble, the twig, and the late edition are things in the Priority Lab.</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline">The early bird is early-described. The late edition is late-described. The unseen object is never-described.</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline">The worm is icky.</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline">The high window is in Priority Lab. It is sightline-described and fixed in place. The initial appearance of the high window is &quot;There&#39;s a tiny high window up near the ceiling that you can&#39;t see unless you&#39;re on top of something.&quot;</div>
</div><p>In order for the priorities we just set to be interesting, let&#39;s give out some initial appearances and writing a paragraph rules:</p>
<div class="codeblock"><div class="codeline">The initial appearance of the worm is &quot;A worm inches along the ground.&quot;</div>
<div class="codeline">The initial appearance of the late edition is &quot;Finally, the late edition lies at your feet.&quot;</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline">Rule for writing a paragraph about the early bird when the early bird is in a room: say &quot;The early bird always appears first, and here it is.&quot;</div>
<div class="codeline">Rule for writing a paragraph about the leaf: say &quot;Look, there&#39;s [a leaf][unless the leaf is in the location] on [the holder of the leaf][end if]!&quot;</div>
<div class="codeline">Rule for writing a paragraph about an icky thing (called icky item) which is on something which supports the player: say &quot;Ew, [an icky item] is right next to you.&quot;</div>
</div><p>This procedure also means (as you can test by experiment) that after the late edition has been picked up and dropped again, it lists in no special order in the &quot;you can see&hellip;&quot; paragraph (since initial appearances only print when the object has not yet been moved).</p>
<div class="codeblock"><div class="codeline">The afterthought is a thing in the Priority Lab. It is latest-described.</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline">The bar stool is an enterable supporter in Priority Lab.</div>
<div class="codeline">&ensp;&ensp;</div>
<div class="codeline">Test me with &quot;get leaf / drop leaf / look / x unseen object / get pebble / look / get twig / look / get afterthought / look / drop twig / look / get late edition / look / drop late edition / sit on bar stool / look / get all / put all on stool / look&quot;.</div>
</div><details class="testme-output"><summary>Test me with "get leaf / drop leaf / look / x unseen object / get pebble / look / get twig / look / get afterthought / look / drop twig / look / get late edition / look / drop late edition / sit on bar stool / look / get all / put all on stool / look".</summary><div class="testme-output">Priority Lab<br>Locale Priority list:<br>  yourself: 5<br>  early bird: 1<br>  worm: 5<br>  leaf: 5<br>  pebble: 5<br>  twig: 5<br>  late edition: 10<br>  afterthought: 5<br>  bar stool: 5<br><br>The early bird always appears first, and here it is.<br><br>A worm inches along the ground.<br><br>Look, there's a leaf!<br><br>Finally, the late edition lies at your feet.<br><br>You can also see a pebble, a twig and a bar stool here.<br><br>Oh! And also an afterthought.<br><br>>(Testing.)<br><br>>[1] get leaf<br>Taken.<br><br>>[2] drop leaf<br>Dropped.<br><br>>[3] look<br>Priority Lab<br>Locale Priority list:<br>  leaf: 5<br>  yourself: 5<br>  early bird: 1<br>  worm: 5<br>  pebble: 5<br>  twig: 5<br>  late edition: 10<br>  afterthought: 5<br>  bar stool: 5<br><br>The early bird always appears first, and here it is.<br><br>Look, there's a leaf!<br><br>A worm inches along the ground.<br><br>Finally, the late edition lies at your feet.<br><br>You can also see a pebble, a twig and a bar stool here.<br><br>Oh! And also an afterthought.<br><br>>[4] x unseen object<br>You see nothing special about the unseen object.<br><br>>[5] get pebble<br>Taken.<br><br>>[6] look<br>Priority Lab<br>Locale Priority list:<br>  leaf: 5<br>  yourself: 5<br>  early bird: 1<br>  worm: 5<br>  twig: 5<br>  late edition: 10<br>  afterthought: 5<br>  bar stool: 5<br><br>The early bird always appears first, and here it is.<br><br>Look, there's a leaf!<br><br>A worm inches along the ground.<br><br>Finally, the late edition lies at your feet.<br><br>You can also see a twig and a bar stool here.<br><br>Oh! And also an afterthought.<br><br>>[7] get twig<br>Taken.<br><br>>[8] look<br>Priority Lab<br>Locale Priority list:<br>  leaf: 5<br>  yourself: 5<br>  early bird: 1<br>  worm: 5<br>  late edition: 10<br>  afterthought: 5<br>  bar stool: 5<br><br>The early bird always appears first, and here it is.<br><br>Look, there's a leaf!<br><br>A worm inches along the ground.<br><br>Finally, the late edition lies at your feet.<br><br>You can also see a bar stool here.<br><br>Oh! And also an afterthought.<br><br>>[9] get afterthought<br>Taken.<br><br>>[10] look<br>Priority Lab<br>Locale Priority list:<br>  leaf: 5<br>  yourself: 5<br>  early bird: 1<br>  worm: 5<br>  late edition: 10<br>  bar stool: 5<br><br>The early bird always appears first, and here it is.<br><br>Look, there's a leaf!<br><br>A worm inches along the ground.<br><br>Finally, the late edition lies at your feet.<br><br>You can also see a bar stool here.<br><br>>[11] drop twig<br>Dropped.<br><br>>[12] look<br>Priority Lab<br>Locale Priority list:<br>  twig: 5<br>  leaf: 5<br>  yourself: 5<br>  early bird: 1<br>  worm: 5<br>  late edition: 10<br>  bar stool: 5<br><br>The early bird always appears first, and here it is.<br><br>Look, there's a leaf!<br><br>A worm inches along the ground.<br><br>Finally, the late edition lies at your feet.<br><br>You can also see a twig and a bar stool here.<br><br>>[13] get late edition<br>Taken.<br><br>>[14] look<br>Priority Lab<br>Locale Priority list:<br>  twig: 5<br>  leaf: 5<br>  yourself: 5<br>  early bird: 1<br>  worm: 5<br>  bar stool: 5<br><br>The early bird always appears first, and here it is.<br><br>Look, there's a leaf!<br><br>A worm inches along the ground.<br><br>You can also see a twig and a bar stool here.<br><br>>[15] drop late edition<br>Dropped.<br><br>>[16] sit on bar stool<br>You get onto the bar stool.<br><br>Locale Priority list:<br>  yourself: 5<br><br>>[17] look<br>Priority Lab (on the bar stool)<br>Locale Priority list:<br>  late edition: 10<br>  twig: 5<br>  leaf: 5<br>  early bird: 1<br>  worm: 5<br>  high window: 5<br>  bar stool: 5<br><br>The early bird always appears first, and here it is.<br><br>Look, there's a leaf!<br><br>A worm inches along the ground.<br><br>There's a tiny high window up near the ceiling that you can't see unless you're on top of something.<br><br>You can also see a late edition and a twig here.<br><br>Locale Priority list:<br>  yourself: 5<br><br>>[18] get all<br>late edition: Taken.<br>twig: Taken.<br>leaf: Taken.<br>early bird: Taken.<br>worm: Taken.<br>unseen object: Taken.<br><br>>[19] put all on stool<br>unseen object: Dropped.<br>worm: Dropped.<br>early bird: Dropped.<br>leaf: Dropped.<br>twig: Dropped.<br>late edition: Dropped.<br>afterthought: Dropped.<br>pebble: Dropped.<br><br>>[20] look<br>Priority Lab (on the bar stool)<br>Locale Priority list:<br>  high window: 5<br>  bar stool: 5<br><br>There's a tiny high window up near the ceiling that you can't see unless you're on top of something.<br><br>Locale Priority list:<br>  pebble: 5<br>  afterthought: 5<br>  late edition: 10<br>  twig: 5<br>  leaf: 5<br>  early bird: 1<br>  worm: 10<br>  yourself: 5<br><br>Look, there's a leaf on the bar stool!<br><br>Ew, a worm is right next to you.<br><br>On the bar stool you can also see a pebble, a late edition, a twig and an early bird.<br><br>Oh! And also an afterthought.
</div></details><div class="doc-navbar"><div class="doc-navbar-left"><a href="eye_of_the_idol.html" title="A systematic way to allow objects in certain places to be described in the room description body text rather than in paragraphs following the room description, and to control whether supporters list their contents or not.">357. The Eye of the Idol</a></div><div class="doc-navbar-right"><a href="low_light.html" title="An object that is only visible and manipulable when a bright light fixture is on.">359. Low Light</a></div></div>
<nav><div class="nav-el"><a href="../index.html">Contents</a></div> <div class="nav-el"><a href="../examples/index.html">Examples</a></div> <div class="nav-el"><a href="../general_index.html">Index</a></div> <div class="nav-el"><a href="../search.html">Search</a></div></nav>
<footer id="credits-footer"><p><a href="http://inform7.com">Inform 7</a> and its documentation are &copy; 2006-<span id="current_year">2022</span> by Graham Nelson and published under the <a href="../license.html">Artistic License 2.0</a>.</p><p>Thanks go to <a href="http://nitku.net/blog/">Juhana Leinonen</a> for <a href="https://borogove.app">Borogove</a>. The playable examples use <a href="https://eblong.com">Andrew Plotkin</a>'s <a href="https://eblong.com/zarf/glk/glkote.html">GlkOte</a> and <a href="https://eblong.com/zarf/glulx/quixe/index.html">Quixe</a>, distributed under an <a href="../mit.html">MIT License.</a></p><p class="about"><a href="../about.html">About this edition</a> &bull; <a href="https://twitter.com/inform7tips">@inform7tips</a></p></footer>
</body></html>
